<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 3 - Attention Test - Le Boncoin UX Research</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f6f6f6;
        }

        header {
            background: #ff6e14;
            color: white;
            padding: 15px;
            font-size: 22px;
            text-align: center;
            font-weight: bold;
        }

        #app {
            width: 100%;
            height: calc(100vh - 60px);
            position: relative;
            display: flex;
            flex-direction: column;
            background: #f0f0f0;
            justify-content: center;
            align-items: center;
        }

        /* ===== INTRO SCREEN ===== */
#intro-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    background: #764ba2; /* violet uniforme */
    color: white;
    text-align: center;
    padding: 40px;
    width: 100%;
}


        #intro-screen h1 {
            font-size: 48px;
            margin-bottom: 20px;
        }

        #intro-screen p {
            font-size: 18px;
            max-width: 600px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        #intro-screen button {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #intro-screen button:hover {
            transform: scale(1.05);
        }

        /* ===== MAIN CONTENT AREA ===== */
        #main-content {
            display: none;
            flex: 1;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin: 20px;
            height: 80vh;
            max-height: 800px;
        }

        #main-content.active {
            display: flex;
            flex-direction: column;
        }

        /* ===== INSTRUCTIONS ===== */
        #instructions {
            background: white;
            border-bottom: 2px solid #ff6e14;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #instructions h3 {
            color: #ff6e14;
            font-size: 16px;
            margin-right: 20px;
        }

        #instructions p {
            font-size: 14px;
            color: #333;
            margin: 0;
        }

        .timer {
            font-size: 28px;
            font-weight: bold;
            color: #ff6e14;
            min-width: 80px;
            text-align: right;
        }

        .timer.warning {
            color: #e55a00;
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* ===== PRODUCT LIST VIEW ===== */
        #product-list-wrapper {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        #product-list-wrapper.modal-open {
            filter: blur(2px);
        }

        .product-list {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 20px;
            background: white;
        }

        .product-list.scrollable {
            overflow-y: scroll;
        }

        .product-list.non-scrollable {
            overflow: hidden;
        }

        .product-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            user-select: none;
        }

        .product-card:hover {
            background: #f9f9f9;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            border-color: #ff6e14;
            transform: translateY(-2px);
        }

        .product-card.clickable {
            cursor: crosshair;
        }

        .product-card.clickable:hover {
            border: 3px solid #ff6e14;
            background: #fff9f0;
            box-shadow: 0 4px 20px rgba(255, 110, 20, 0.3);
        }

        .product-card.clickable.selected {
            border: 3px solid #4caf50;
            background: #f0fff4;
        }

        .product-card.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .product-card.disabled:hover {
            border-color: #ddd;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: none;
        }

        .product-image {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 6px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
        }

        .product-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 6px;
            justify-content: center;
        }

        .product-title {
            font-weight: bold;
            font-size: 15px;
            color: #333;
        }

        .product-price {
            font-size: 20px;
            color: #ff6e14;
            font-weight: bold;
        }

        .product-seller {
            font-size: 13px;
            color: #666;
        }

        .product-location {
            font-size: 13px;
            color: #999;
        }

        .product-date {
            font-size: 12px;
            color: #bbb;
        }

        /* ===== MODAL ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 400px;
            background: rgba(255,255,255,0.95);
            z-index: 100;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .modal-overlay.active {
            display: block;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 10px;
            font-size: 22px;
        }

        .modal-content p {
            color: #666;
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .modal-btn {
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn.primary {
            background: #ff6e14;
            color: white;
        }

        .modal-btn.primary:hover {
            background: #e55a00;
        }

        .modal-btn.secondary {
            background: #f0f0f0;
            color: #333;
        }

        .modal-btn.secondary:hover {
            background: #e0e0e0;
        }

        .modal-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .selected-info {
            background: #fff9f0;
            border: 2px solid #ff6e14;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 20px;
            text-align: left;
        }

        .selected-info.empty {
            display: none;
        }

        .selected-info h4 {
            color: #ff6e14;
            margin: 0 0 5px 0;
            font-size: 13px;
        }

        .selected-info p {
            margin: 0;
            font-size: 13px;
            color: #333;
        }

        /* ===== RESULTS SCREEN ===== */
        #results-screen {
            display: none;
            flex: 1;
            width: 100%;
            padding: 40px 20px;
            overflow-y: auto;
            background: white;
        }

        #results-screen.active {
            display: block;
        }

        .results-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .results-container h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
            text-align: center;
        }

        .test-result {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .test-result h3 {
            color: #ff6e14;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .result-item {
            background: white;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ff6e14;
        }

        .final-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
        }

        .final-btn {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .final-btn.primary {
            background: #ff6e14;
            color: white;
        }

        .final-btn.primary:hover {
            background: #e55a00;
        }

        .final-btn.secondary {
            background: #f0f0f0;
            color: #333;
        }

        .final-btn.secondary:hover {
            background: #e0e0e0;
        }
    </style>
</head>
<body>
<header>Phase 3 - Attention and reliability Test - Le Boncoin üéØ</header>

<div id="app">
    <!-- INTRO SCREEN -->
    <div id="intro-screen">
        <h1>üéØ Phase 3 : Attention Test</h1>
        <p>
            You will see product lists for <strong>10, 30 et 60 secondes</strong>.<br>
            <strong>You can scroll</strong> and observe the listings.<br>
            <br>
            At the end of each duration, <strong>you will be asked to click on the listing</strong> that interested you the most.
        </p>
        <button onclick="startTest()">Start the test</button>
    </div>

    <div id="prepare-screen" style="display:none; width:100%; height:100%; background:#764ba2; color:white; display:flex; flex-direction:column; justify-content:center; align-items:center; font-size:32px;">
         <p id="prepare-text"></p>
     </div>

    <!-- MAIN CONTENT AREA -->
    <div id="main-content">
        <!-- INSTRUCTIONS BAR -->
        <div id="instructions">
            <div>
                <h3 id="phase-title">Phase 1/3</h3>
                <p id="phase-text">Waiting...</p>
            </div>
            <div class="timer" id="timer">-</div>
        </div>

        <!-- PRODUCT LIST -->
        <div id="product-list-wrapper">
            <div class="product-list" id="product-list">
                <!-- Produits g√©n√©r√©s dynamiquement -->
            </div>
        </div>
    </div>

    <!-- CLICK QUESTION MODAL -->
    <div class="modal-overlay" id="click-modal">
        <div class="modal-content">
            <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" alt="Choisissez" style="width:100px; margin-bottom:20px;">
            <h2 id="modal-title">üïí You have 10 seconds to choose!</h2>
            <p id="modal-text">Click on the listing that interests you the most.</p>
            <div class="selected-info empty" id="selected-info" style="margin-top:20px;">
                <h4>‚úÖ Selection :</h4>
                <p id="selected-product"></p>
            </div>
            <div class="modal-buttons" style="margin-top:20px;">
                <button class="modal-btn secondary" onclick="skipQuestion()">Skip</button>
                <button class="modal-btn primary" id="confirm-btn" style="display:none;" onclick="confirmSelection()">Confirm</button>
            </div>
        </div>
    </div>

    <!-- MOTIVATION MODAL -->
    <div class="modal-overlay" id="motivation-modal">
        <div class="modal-content">
            <h2 id="motivation-title">Pourquoi ce choix ?</h2>
            <p id="motivation-text">Qu'est-ce qui vous a motiv√© √† choisir cette annonce ? (plusieurs choix possibles)</p>
            <div id="motivation-checkboxes" style="text-align: left; margin-bottom: 20px;">
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="prix-bas"> üí∞ Low price
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="prix-eleve"> üìà High price
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="condition"> ‚ú® Good Condition
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="vendeur"> üë§ Reliable seller
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="localisation"> üìç Location
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="marque"> üè∑Ô∏è Brand/Model
                </label>
                <label style="display: block; margin: 10px 0; cursor: pointer;">
                    <input type="checkbox" name="motivation" value="recente"> ‚è∞ Recent listing
                </label>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="skipMotivation()">Skip</button>
                <button class="modal-btn primary" onclick="confirmMotivation()">Continue</button>
            </div>
        </div>
    </div>

    <!-- RESULTS SCREEN -->
    <div id="results-screen">
        <div class="results-container">
            <h2>üìä Your attention test results</h2>
            <div id="results-content">
                <!-- R√©sultats g√©n√©r√©s dynamiquement -->
            </div>
            <div class="final-buttons">
                <button class="final-btn secondary" onclick="downloadResults()">üì• Download results</button>
                <button class="final-btn primary" onclick="location.reload()">‚Üª Restart</button>
            </div>
        </div>
    </div>
</div>


<script>
    // ===== GLOBAL STATE =====
    const DURATIONS = [10, 30, 60]; // en secondes
    let testResults = [];
    let currentPhaseIndex = 0;
    let currentDuration = 0;
    let timeRemaining = 0;
    let isViewingPhase = false;
    let isSelectionPhase = false;
    let selectedProductId = null;
    let timerInterval = null;
    let products = [];

    // ===== PRODUCT DATA =====
    const REAL_PRODUCTS = [
        { title: 'IPhone 16 Pro Max 256GB GARANTIE 2 ANS', price: 1099, seller: 'TechPro Store', location: 'Paris (75)', daysAgo: 1, condition: 'Bon √©tat', image: 'https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=300&h=300&fit=crop' },
        { title: 'Apple IPhone 16 128GB GARANTIE 2 Ans', price: 849, seller: 'MobileExperts', location: 'Lyon (69)', daysAgo: 2, condition: 'Excellent √©tat', image: 'https://images.unsplash.com/photo-1592286927505-ed0bd6a0d4a0?w=300&h=300&fit=crop' },
        { title: 'Samsung Galaxy S24 Ultra', price: 899, seller: 'ElectroMax', location: 'Marseille (13)', daysAgo: 1, condition: 'Tr√®s bon √©tat', image: 'https://images.unsplash.com/photo-1610945415295-d9bbf067e59c?w=300&h=300&fit=crop' },
        { title: 'Google Pixel 9 Pro', price: 649, seller: 'TechHub', location: 'Toulouse (31)', daysAgo: 3, condition: 'Bon √©tat', image: 'https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=300&h=300&fit=crop' },
        { title: 'OnePlus 12 Pro', price: 549, seller: 'FastPhone', location: 'Nice (06)', daysAgo: 2, condition: 'Excellent √©tat', image: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=300&h=300&fit=crop' },
        { title: 'Xiaomi 14 Ultra', price: 479, seller: 'ChinaTech', location: 'Nantes (44)', daysAgo: 4, condition: 'Tr√®s bon √©tat', image: 'https://images.unsplash.com/photo-1567581935884-3349723552ca?w=300&h=300&fit=crop' },
        { title: 'iPhone 15 Pro', price: 799, seller: 'ProTrade', location: 'Strasbourg (67)', daysAgo: 1, condition: 'Bon √©tat', image: 'https://images.unsplash.com/photo-1697026037043-6c0dfbbdaf72?w=300&h=300&fit=crop' },
        { title: 'Samsung Galaxy A55', price: 299, seller: 'MobileWorld', location: 'Montpellier (34)', daysAgo: 5, condition: 'Bon √©tat', image: 'https://images.unsplash.com/photo-1585060544812-6b45742d762f?w=300&h=300&fit=crop' },
        { title: 'Apple iPhone 14', price: 599, seller: 'TechStore_Pro', location: 'Bordeaux (33)', daysAgo: 2, condition: 'Tr√®s bon √©tat', image: 'https://images.unsplash.com/photo-1663499482523-1c0d8c17d41f?w=300&h=300&fit=crop' },
        { title: 'Nothing Phone 2', price: 359, seller: 'InnovateTech', location: 'Lille (59)', daysAgo: 3, condition: 'Excellent √©tat', image: 'https://images.unsplash.com/photo-1574944985070-8f3ebc6b79d2?w=300&h=300&fit=crop' }
    ];

    function log(msg) {
        const timestamp = new Date().toLocaleTimeString();
        console.log(`[${timestamp}] ${msg}`);
    }

    // ===== RENDER PRODUCTS =====
    function renderProducts(clickable = false) {
        const container = document.getElementById('product-list');
        products = [...REAL_PRODUCTS].sort(() => Math.random() - 0.5);

        container.innerHTML = products.map((p, idx) => `
            <div class="product-card ${clickable ? 'clickable' : 'disabled'}" 
                 data-product-id="${idx}"
                 onclick="handleProductClick(event, ${idx})">
                <div class="product-image" style="background-image: url('${p.image}'); background-size: cover; background-position: center;"></div>
                <div class="product-info">
                    <div class="product-title">${p.title}</div>
                    <div class="product-price">${p.price}‚Ç¨</div>
                    <div class="product-seller">üì¶ ${p.seller}</div>
                    <div class="product-location">üìç ${p.location} ‚Ä¢ ${p.condition}</div>
                    <div class="product-date">Il y a ${p.daysAgo}j</div>
                </div>
            </div>
        `).join('');

        log(`‚úÖ ${products.length} produits rendus (clickable: ${clickable})`);
    }

    // ===== START TEST =====
    function startTest() {
        log('üöÄ D√©marrage du test');
        document.getElementById('intro-screen').style.display = 'none';
        document.getElementById('main-content').classList.add('active');
        startNextPhase();
    }

    function startNextPhase() {
        if (currentPhaseIndex >= DURATIONS.length) {
        // Nettoyage avant l'affichage des r√©sultats
        document.getElementById('phase-title').textContent = "";
        document.getElementById('phase-text').textContent = "";
        showResults();
        return;
    }
        if (currentPhaseIndex >= DURATIONS.length) {
            showResults();
            return;
        }

        currentDuration = DURATIONS[currentPhaseIndex];
        showPrepareScreen(currentDuration);
    }

    function showPrepareScreen(duration) {
        document.getElementById('main-content').style.display = 'none';
        const prep = document.getElementById('prepare-screen');
        prep.style.display = 'flex';
        document.getElementById('prepare-text').textContent = `üìå You will have ${duration} seconds to observe the listings`;
        
        setTimeout(() => {
            prep.style.display = 'none';
            document.getElementById('main-content').style.display = 'flex';
            startViewingPhase(duration);
        }, 3000);
    }

    function startViewingPhase(duration) {
        isViewingPhase = true;
        isSelectionPhase = false;
        selectedProductId = null;
        timeRemaining = duration;

        document.getElementById('phase-title').textContent = `Phase ${currentPhaseIndex + 1}/3`;
        document.getElementById('phase-text').textContent = `Observe the listings for ${duration}s. You can scroll.`;
        document.getElementById('click-modal').classList.remove('active');

        renderProducts(false);
        startTimer();
    }

    function startTimer() {
        const timerElement = document.getElementById('timer');

        if (timerInterval) clearInterval(timerInterval);

        timerElement.textContent = `${timeRemaining}s`;
        timerElement.classList.remove('warning');

        timerInterval = setInterval(() => {
            timeRemaining--;
            timerElement.textContent = `${timeRemaining}s`;

            if (timeRemaining <= 3) timerElement.classList.add('warning');

            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                completePhase();
            }
        }, 1000);
    }
function completePhase() {
    log(`‚è±Ô∏è Phase ${currentPhaseIndex + 1} termin√©e`);
    isViewingPhase = false;

    // Cr√©er un popup temporaire pour le message "Vous avez 5 secondes pour cliquer"
    const popup = document.createElement('div');
    popup.textContent = '‚è±Ô∏è You have 3 seconds to click on the listing that interested you!';
    popup.style.position = 'absolute';
    popup.style.top = '50%';
    popup.style.left = '50%';
    popup.style.transform = 'translate(-50%, -50%)';
    popup.style.background = '#fffae6';
    popup.style.color = '#333';
    popup.style.fontSize = '24px';
    popup.style.fontWeight = 'bold';
    popup.style.padding = '20px';
    popup.style.borderRadius = '12px';
    popup.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
    popup.style.textAlign = 'center';
    popup.style.zIndex = '1000';

    document.getElementById('app').appendChild(popup);

    // Apr√®s 3 secondes, retirer le popup et rendre les produits cliquables
    setTimeout(() => {
    popup.remove();

    document.querySelectorAll('.product-card').forEach(card => {
        card.classList.remove('disabled');
        card.classList.add('clickable');
    });
    isSelectionPhase = true;
    selectedProductId = null;

    // Timer pour 5 secondes de clic possible
    let selectionTime = 3;
    const interval = setInterval(() => {
        selectionTime--;
        if (selectionTime <= 0) {
            clearInterval(interval);
            isSelectionPhase = false;

            if (selectedProductId !== null) {
                document.getElementById('motivation-modal').classList.add('active');
                document.querySelectorAll('input[name="motivation"]').forEach(cb => cb.checked = false);
            } else {
                currentPhaseIndex++;
                setTimeout(() => startNextPhase(), 500);
            }
        }
    }, 1000);

}, 3000);
    }

    function handleProductClick(event, productId) {
        if (!isSelectionPhase) return;

        selectedProductId = productId;
        const product = products[productId];

        document.querySelectorAll('.product-card.selected').forEach(card => card.classList.remove('selected'));
        event.currentTarget.classList.add('selected');

        const selectedInfo = document.getElementById('selected-info');
        document.getElementById('selected-product').textContent = `${product.title} - ${product.price}‚Ç¨`;
        selectedInfo.classList.remove('empty');

        document.getElementById('confirm-btn').style.display = 'block';
    }

    function confirmSelection() {
        document.getElementById('click-modal').classList.remove('active');
        document.getElementById('motivation-modal').classList.add('active');

        document.querySelectorAll('input[name="motivation"]').forEach(checkbox => checkbox.checked = false);
    }

    function confirmMotivation() {
        if (selectedProductId === null) return;

        const product = products[selectedProductId];
        const motivations = Array.from(document.querySelectorAll('input[name="motivation"]:checked')).map(cb => cb.value);

        testResults.push({
            phase: currentPhaseIndex + 1,
            duration: currentDuration,
            selectedProduct: product,
            motivations: motivations
        });

        document.getElementById('motivation-modal').classList.remove('active');
        document.getElementById('product-list-wrapper').classList.remove('modal-open');

        currentPhaseIndex++;
        setTimeout(() => startNextPhase(), 500);
    }

    function skipMotivation() {
        if (selectedProductId === null) return;

        const product = products[selectedProductId];

        testResults.push({
            phase: currentPhaseIndex + 1,
            duration: currentDuration,
            selectedProduct: product,
            motivations: []
        });

        document.getElementById('motivation-modal').classList.remove('active');
        document.getElementById('product-list-wrapper').classList.remove('modal-open');

        currentPhaseIndex++;
        setTimeout(() => startNextPhase(), 500);
    }

    function skipQuestion() {
        testResults.push({
            phase: currentPhaseIndex + 1,
            duration: currentDuration,
            selectedProduct: null
        });

        document.getElementById('click-modal').classList.remove('active');
        document.getElementById('product-list-wrapper').classList.remove('modal-open');
        currentPhaseIndex++;
        setTimeout(() => startNextPhase(), 500);
    }

function showResults() {
    // Masquer le contenu principal ET la barre d'instructions
    document.getElementById('main-content').style.display = 'none'; 
    document.getElementById('main-content').classList.remove('active');
    
    // Afficher l'√©cran des r√©sultats
    document.getElementById('results-screen').classList.add('active');
    document.getElementById('main-content').classList.remove('active');
    document.getElementById('results-screen').classList.add('active');

    const resultsHTML = testResults.map(result => `
        <div class="test-result">
            <h3>‚è±Ô∏è Test ${result.phase} - ${result.duration} seconds</h3>
            ${result.selectedProduct ? `
                <div class="result-item">
                    <strong>${result.selectedProduct.title}</strong><br>
                    ${result.selectedProduct.price}‚Ç¨ ‚Ä¢ ${result.selectedProduct.seller} ‚Ä¢ ${result.selectedProduct.location}
                </div>
                ${result.motivations && result.motivations.length > 0 ? `
                    <div class="result-item" style="margin-top: 8px; padding: 8px; background-color: #f0f0f0; border-radius: 4px;">
                        <strong>Motivations:</strong> ${result.motivations.map(m => {
                            const labels = {
                                'prix-bas': 'üí∞ Low price',
                                'prix-eleve': 'üìà High price',
                                'condition': '‚ú® Good Condition',
                                'vendeur': 'üë§ Reliable seller',
                                'localisation': 'üìç Location',
                                'marque': 'üè∑Ô∏è Brand/Model',
                                'recente': '‚è∞ Recent listing'
                            };
                            return labels[m] || m;
                        }).join(', ')}
                    </div>
                ` : `<div class="result-item" style="margin-top: 8px; color: #999;"><em>No motivation selected</em></div>`}
            ` : `<div class="result-item">‚úÖ Aucune s√©lection</div>`}
        </div>
    `).join('');

    document.getElementById('results-content').innerHTML = resultsHTML;
    downloadResults();

    // Ajouter le bouton "Continuer vers la conclusion" correctement
    const finalButtonsDiv = document.querySelector('#results-screen .final-buttons');
    const conclusionBtn = document.createElement('button');
    conclusionBtn.textContent = "‚û°Ô∏è Continue to the conclusion";
    conclusionBtn.className = "final-btn primary";
    conclusionBtn.onclick = showConclusion;
    finalButtonsDiv.appendChild(conclusionBtn);
}


    function downloadResults() {
        const data = { timestamp: new Date().toISOString(), tests: testResults };
        const json = JSON.stringify(data, null, 2);
        const blob = new Blob([json], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `phase3-results-${Date.now()}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    function showConclusion() {
    // Masquer l'√©cran des r√©sultats
    document.getElementById('results-screen').classList.remove('active');

    // Cr√©er un √©cran de conclusion
    const app = document.getElementById('app');
    const conclusionDiv = document.createElement('div');
    conclusionDiv.id = 'conclusion-screen';
    conclusionDiv.style.display = 'flex';
    conclusionDiv.style.flexDirection = 'column';
    conclusionDiv.style.justifyContent = 'center';
    conclusionDiv.style.alignItems = 'center';
    conclusionDiv.style.height = '80vh';
    conclusionDiv.style.textAlign = 'center';
    conclusionDiv.style.padding = '40px';
    conclusionDiv.style.background = 'white';
    conclusionDiv.style.borderRadius = '12px';
    conclusionDiv.style.boxShadow = '0 4px 16px rgba(0,0,0,0.1)';
    conclusionDiv.innerHTML = `
        <h1>üéâ Thank you for your participation!</h1>
        <p>‚úÖ Don‚Äôt forget to upload the 3 files to the Drive:</p>
        <a href="https://drive.google.com/drive/folders/1V86xNzyIHldoCjV73pPFZZ8WjbUOY_uo?usp=sharing" target="_blank" style="color:#ff6e14; font-weight:bold; text-decoration:none;">üìÇ Ouvrir le Drive</a>
        <p>Thank you for your time and attention!</p>
    `;

    app.appendChild(conclusionDiv);
}



    log('‚úÖ Application initialis√©e');


</script>
</body>
</html>
